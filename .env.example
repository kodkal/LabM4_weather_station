cd ~/LabM4_weather_station

# 1. DELETE the corrupted .env completely
rm -f .env

# 2. Create a BRAND NEW clean .env (copy this ENTIRE block)
cat > .env << 'ENVFILE'
SECRET_KEY=temp-secret-key
JWT_SECRET_KEY=temp-jwt-key
SENSOR_TYPE=SIMULATED
SENSOR_SIMULATION=true
SENSOR_PIN=4
DEVICE_ID=weather-station-001
LOCATION=Utah
API_PORT=8443
DEBUG=True
DATABASE_URL=sqlite:///weather_data.db
LOG_LEVEL=INFO
LOG_FILE=logs/weather_station.log
ENVFILE

# 3. Generate secure keys
python3 << 'PYSCRIPT'
import secrets
secret = secrets.token_urlsafe(32)
jwt = secrets.token_urlsafe(32)
with open('.env', 'r') as f:
    content = f.read()
content = content.replace('temp-secret-key', secret)
content = content.replace('temp-jwt-key', jwt)
with open('.env', 'w') as f:
    f.write(content)
print("âœ“ Secure keys generated")
PYSCRIPT

# 4. Check what's in settings.py
echo "Checking settings.py..."
head -60 settings.py

# 5. Try starting
./start_weather_station.sh